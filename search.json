[
  {
    "objectID": "Lab02.html#exercise-1-soil-carbon-walk-through",
    "href": "Lab02.html#exercise-1-soil-carbon-walk-through",
    "title": "Lab 02",
    "section": "Exercise 1 – Soil carbon (walk-through)",
    "text": "Exercise 1 – Soil carbon (walk-through)\nKarunaratne et al. (2012)1 measured soil carbon (%) in the Cox’s creek catchment in northern NSW using a stratified random sampling scheme. The results are summarised below.\n\nUSE is the land use type;\nN is the number of samples collected;\nMEAN is the mean soil carbon content;\nVARIANCE is the variance of the mean;\nPERCENT_AREA is the percentage of the catchment area represented by each land use type.\n\n\n\n1Karunaratne S. B., Bishop T. F. A., Odeh I. O. A., Baldock J. A., Marchant B. P. (2014) Estimating change in soil organic carbon using legacy data as the baseline: issues, approaches and lessons to learn. Soil Research 52, 349-365.\n\n\n\n\n\nuse\nn\nmean\nvariance\npercent_area\n\n\n\n\nForest\n9\n0.65\n1.4\n20\n\n\nDryland Cropping\n14\n0.96\n0.4\n35\n\n\nPasture-Vertosol\n14\n1.06\n0.8\n35\n\n\nPasture-Other\n2\n1.31\n0.4\n6\n\n\nIrrigated\n5\n0.78\n0.8\n4\n\n\nOverall\n44\n0.92\n1.0\n100\n\n\n\n\n\nRecall that the confidence interval for the mean is an effective way to communicate the precision of the estimates (how well we know the true mean), and is derived from the standard error of the mean.\n\nCalculating the 95% confidence interval of the mean\nThe weighted mean (y_s) and variance (Var(\\bar y_s)) of the mean for a stratified random sample are given by:\n\n\nWeighted mean:\n\nCalculate mean value per stratum\nMultiply each mean value by the weight of the stratum\nSum the weighted mean values to get the overall mean\n\n\\bar y_s = \\sum_{i=1}^L \\bar y_i \\times w_i\nwhere L is the number of strata, \\bar y_i is the mean of stratum i, and w_i is the weight of stratum i, and\n\n\nWeighted variance of the mean:\n\nCalculate the variance of the mean for each stratum\nMultiply the variance of the mean by the square of the weight of the stratum\nSum all the weighted variances to get the overall variance of the mean\n\nVar(\\bar y_s) = \\sum_{i=1}^L w_i^2 \\times Var(\\bar y_i)\nwhere Var(\\bar y_i) is the variance of the mean for stratum i.\nWe can then calculate the 95% CI for the mean:\n\n\n95% CI for the mean:\n\nWeighted mean plus (t-critical value \\times standard error of the mean)\nWeighted mean minus (t-critical value \\times standard error of the mean)\n\n95\\% CI = \\bar y_s \\pm t^{0.025}_{n-L} \\times \\sqrt{Var(\\bar y_s)}\nwhere L = number of strata, n = total number of samples, t^{0.025}_{n-L} is the t-critical value for the 95% CI and \\sqrt{Var(\\bar y_s)} is the variance of the mean for the stratified random sample.\nIs stratified random sampling a good idea for this study? Let’s find out.\n\n\n\n\n\n\nImportant\n\n\n\nUnderstanding how to calculate the 95% CI using summary statistics is examinable. If you find it difficult to understand the mathematical notation, it might be easier to rewrite them in your own words – for example, see the side notes. We will never ask you to calculate values directly, but will ask you to interpret the results.\n\n\n\n\nDoing the calculations in R\nThe data is provided below. The first is the stratified dataset, which contains the mean and variance of the soil carbon content for each land use type.\n\nstratified &lt;- data.frame(\n    use = c(\n        \"Forest\", \"Dryland Cropping\", \"Pasture-Vertosol\", \"Pasture-Other\",\n        \"Irrigated\"\n    ),\n    n = c(9, 14, 14, 2, 5),\n    mean = c(0.65, 0.96, 1.06, 1.31, 0.78),\n    variance = c(1.4, 0.4, 0.8, 0.4, 0.8),\n    percent_area = c(20, 35, 35, 6, 4)\n)\n\nYou should copy and paste this data into your own document and run stratified to view the data.\nLook at the code and see if you can understand how a data frame is created in R. The data.frame function is used to create a data frame, and the c function is used to create vectors of data. Each vector forms a column in the data frame.\n\nQuestion 1\nEstimate the mean and associated 95% CI assuming stratified random sampling using the carbon dataset. We can use the weighted.mean function to calculate the weighted mean, and the qt function to calculate the t-critical value for a 95% CI. You should find out what these functions do by seeking their help documentation using the ? operator.\n?weighted.mean\n?qt\nThe standard error of the mean can be calculated using the following:\n# SE: square_root(sum(weighted variance of the mean))\n\n\nTip: you can manipulate the object and subset specific rows, columns or cells using $ and [] respectively. For example, to access the mean column of the carbon dataset, you can use carbon$mean. To access the mean value for the Forest stratum, you can use carbon$mean[1].\nFinally, the 95% CI can be calculated using the following:\n# 95% CI = weighted mean ± (t_crit * SE)\n\n\n\n\n\n\nSolution 1\n\n\n\n\n# Weighted mean:\nweighted_mean &lt;- weighted.mean(stratified$mean, stratified$percent_area)\n\n# t-crit value for a 95% CI\ndegrees_freedom &lt;- sum(stratified$n) - nrow(stratified)\ntcrit &lt;- qt(0.975, df = degrees_freedom)\n\n# SE of the mean: variance/n * weight^2\nweight &lt;- stratified$percent_area / 100\nweighted_var_mean &lt;- stratified$variance / stratified$n * weight^2\nSE_mean &lt;- sqrt(sum(weighted_var_mean))\n\n# 95% CI\nci_stratified &lt;- c(\n    mean = weighted_mean,\n    L95 = weighted_mean - (tcrit * SE_mean),\n    U95 = weighted_mean + (tcrit * SE_mean)\n)\n\nci_stratified\n\n    mean      L95      U95 \n0.946800 0.677712 1.215888"
  },
  {
    "objectID": "Lab02.html#exercise-2---soil-carbon-what-if",
    "href": "Lab02.html#exercise-2---soil-carbon-what-if",
    "title": "Lab 02",
    "section": "Exercise 2 - Soil carbon: what if…?",
    "text": "Exercise 2 - Soil carbon: what if…?\nWhat if the authors had used simple random sampling? Below is the data object overall which contains the overall mean and variance of the soil carbon content for the entire catchment. It is also the last row of the table above.\noverall &lt;- data.frame(\n    use = \"Overall\",\n    n = 44,\n    mean = 0.92,\n    variance = 1,\n    percent_area = 100\n)\nCalculating the 95% CI for the mean using simple random sampling is similar to the stratified random sampling. The only difference is that the variance of the mean is calculated using the overall variance and sample size.\nVar(\\bar y) = \\frac{Var(y)}{n}\nwhere Var(y) is the variance of the entire dataset and n is the total number of samples.\nThus the 95% CI for the mean is:\n95\\% CI = \\bar y \\pm t^{0.025}_{n-1} \\times \\sqrt{Var(\\bar y)}\nwhere n is the total number of samples, and t^{0.025}_{n-1} is the t-critical value for the 95% CI.\n\nQuestion 2\nEstimate the mean and associated 95% CI assuming simple random sampling using the overall dataset, recalling that:\n# 95% CI = mean ± (t_crit * SE)\n\n\n\n\n\n\nSolution 2\n\n\n\n\n# Mean value is already given\n# Calculate the variance of the mean\nvar_mean &lt;- overall$variance / overall$n\n\n# Determine the t-critical value for a 95% confidence interval\ntcrit &lt;- qt(0.975, df = overall$n - 1)\n\n# Calculate the confidence interval\nci_overall &lt;- c(\n    mean = overall$mean,\n    L95 = overall$mean - tcrit * sqrt(var_mean),\n    U95 = overall$mean + tcrit * sqrt(var_mean)\n)\n\nci_overall\n\n     mean       L95       U95 \n0.9200000 0.6159722 1.2240278 \n\n\n\n\n\n\nQuestion 3\nWould you recommend stratified random sampling for future surveys? Provide evidence from the results of questions 2 and 3.\n\n\nSolution 3\nYes, the 95% CI is smaller, albeit marginally when stratified random sampling is adopted. Another metric is the efficiency of stratification which is:\n\\frac{Var\\left(\\overline{y}_{SiR}\\right)}{Var\\left(\\overline{y}_{StR}\\right)}=\\frac{0.02273}{0.01770}=1.28\nor, in R:\n\nsum(var_mean) / sum(weighted_var_mean)\n\n[1] 1.284156\n\n\nThe results show that stratified random sampling is 1.28 times more efficient than simple random sampling. This means that to achieve the same level of precision, simple random sampling would require approximately 1.28 times more samples than stratified random sampling. So to achieve the same precision with simple random sampling, we would need approximately 1.28 * 44 = 57 samples."
  },
  {
    "objectID": "Lab02.html#exercise-3---kangaroos",
    "href": "Lab02.html#exercise-3---kangaroos",
    "title": "Lab 02",
    "section": "Exercise 3 - Kangaroos",
    "text": "Exercise 3 - Kangaroos\n\nShould we return to the same locations?\nIn this exercise we will explore the impact that resampling the locations has on the precision (width of the 95% CI) with which we estimate the change in mean between 2 surveys. We will also show the equivalence of this to 2-sample t-tests.\nThe key equation for estimating the variance of the change in mean is:\nVar (\\Delta\\bar{y}) =\n  Var (\\Delta\\bar{y}_2) +\n  Var (\\Delta\\bar{y}_1) -\n  2 \\times Cov(y_1, y_2) \nwhere:\n\nVar (\\Delta\\bar{y}) is the variance of the change in mean between 2 surveys;\nVar (\\Delta\\bar{y}_2) is the variance of the mean for the 1st survey (baseline);\nVar (\\Delta\\bar{y}_1) is the variance of the mean for the 2nd survey (repeat);\nCov(y_1, y_2) is the covariance between the means of the 2 surveys.\n\nWhen we resample the same locations, we include the covariance term which describes the relationship between the observations in the 2 surveys. If resample at different locations we assume the covariance is equal to 0, that is:\n Var (\\Delta\\bar{y}) = Var (\\Delta\\bar{y}_2) + Var (\\Delta\\bar{y}_1) \nIn this exercise we will consider a study where kangaroos (number/km2) were counted in a woodland in an initial survey, and then 2 years later. The data is below.\n\n\n'data.frame':   5 obs. of  2 variables:\n $ baseline: num  4 2 6 1 3\n $ rerun   : num  12 11 13 14 9\n\n\nCan you generate a data.frame object from the output above? Try it yourself first, and then click on show the code below to see the answer (Note: PDF output will not hide the answer).\n\n\nShow the code\nbaseline &lt;- c(4, 2, 6, 1, 3)\nrerun &lt;- c(12, 11, 13, 14, 9)\nkangaroos &lt;- data.frame(baseline, rerun)\n\n\n\nQuestion 4\nIntuitively, what would be the impact on the precison with which we estimate the mean when:\n\nwe resample the same locations in the repeat survey?\nwe sample at different locations in the repeat survey?\n\n\n\n\n\n\n\nSolution 4\n\n\n\n\nWhen we resample the same locations, we include the covariance term which describes the relationship between the observations in the 2 surveys. This will reduce the variance of the change in mean, and hence the 95% CI will be narrower.\nWhen we sample at different locations, we assume the covariance is equal to 0. This will increase the variance of the change in mean, and hence the 95% CI will be wider.\n\nTherefore, intuitively we should always sample at the same location for both surveys, but whether we do or not will depend on the experimental design and the research question!\n\n\n\n\n\nDifferent locations\nLet’s assume that the resampled locations are completely different from the baseline survey. This means that the covariance term is equal to 0.\n\nQuestion 5\nUse R to estimate the 95% CI for the change in mean between the 2 surveys. The equation is:\n95\\%\\ CI=\\Delta\\left(\\bar{y}\\right)\\pm t_{df}^{0.025}\\times\\sqrt{Var\\left(\\Delta\\bar{y}\\right)}\nYou will need to calculate {Var}\\left(\\Delta\\left(\\bar{y}_1\\right)\\right), Var\\left(\\Delta\\left(\\bar{y}_2\\right)\\right), and Cov\\left(\\bar{y}_1,\\bar{y}_2\\right).\nAs a starting point R script for calculating the covariance and variance for the observations is below, as is the code to calculate the t critical value (t_{df}^{0.025}). When we sample at different locations between surveys: df = n_{1}+ n_{2} - 2 = 5 + 5 - 2 = 8\n\n# If you want to isolate data from the two sampling periods:\nt0 &lt;- kangaroos$baseline\nt2 &lt;- kangaroos$rerun\n\n# NOTE: functions below are not assigned to objects.\n# To calculate covariance:\ncov(t0, t2)\n\n# To calculate variances:\nvar(t0)\nvar(t2)\n\n# t-critical value for a 95% CI with 8 degrees of freedom:\nqt(0.975, 8)\n\n\n\n\n\n\n\nSolution 5\n\n\n\nSince we sample different locations in the repeat survey the covariance is equal to 0.\n\n# Assign the  data to objects t0 and t2\nt0 &lt;- kangaroos$baseline\nt2 &lt;- kangaroos$rerun\n\n# Calculate the critical value for a 95% confidence interval using the t-distribution with 8 degrees of freedom\ntcrit1 &lt;- qt(0.975, 8)\n\n# Calculate the mean difference between t2 and t0\ndelta_mean &lt;- mean(t2) - mean(t0)\n\n# Calculate the variance of t2 and t0 and divide by their respective sample sizes\nV_delta_mean &lt;- var(t2) / length(t2) + var(t0) / length(t0)\n\n# Calculate the lower bound of the 95% confidence interval\nL95 &lt;- delta_mean - tcrit1 * sqrt(V_delta_mean)\n\n# Calculate the upper bound of the 95% confidence interval\nU95 &lt;- delta_mean + tcrit1 * sqrt(V_delta_mean)\n\n\nc(mean = delta_mean, L95 = L95, U95 = U95)\n\n     mean       L95       U95 \n 8.600000  5.794625 11.405375 \n\n\nTherefore the mean change is 8.6 and the 95% CI is [5.79,11.41].\n\n\n\n\n\nSame locations\nNow let’s assume that the resampled locations are the same as the baseline survey. This means that the covariance term is not equal to 0.\n\nQuestion 6\nAssuming we resampled the same locations as the baseline survey, use R to estimate the 95% CI for the change in mean between the 2 surveys.\n\n\nNote: when we sample at same locations between surveys the df = number of paired sites - 1 = 5 - 1 = 4.\nHint: the following formulae are used:\n\\Delta \\bar y = \\bar y_2 - \\bar y_1 Var(\\Delta \\bar y) = Var( \\bar y_2) + Var( \\bar y_1) - 2 \\times Cov(\\bar y_1, \\bar y_2)\n\n\n\n\n\n\nSolution 6\n\n\n\nSince we sample at the same locations we have to include the covariance term.\n\ntcrit2 &lt;- qt(0.975, 4)\ndelta_mean &lt;- mean(t2) - mean(t0)\nV_delta_mean &lt;- var(t2) / length(t2) + var(t0) / length(t0) - 2 * (cov(t0, t2) / length(t0))\nL95 &lt;- delta_mean - tcrit2 * sqrt(V_delta_mean)\nU95 &lt;- delta_mean + tcrit2 * sqrt(V_delta_mean)\n\nc(mean = delta_mean, L95 = L95, U95 = U95)\n\n     mean       L95       U95 \n 8.600000  5.245209 11.954791 \n\n\nTherefore the mean change is 8.6 and the 95% CI is [5.25,11.95].\n\n\n\n\nQuestion 7\nWas there a significant change in the mean number of kangaroos between the study period, if we assume the same locations were resampled, or if different locations were sampled?\n\n\n\n\n\n\nSolution 7\n\n\n\nIf the 95% CI does not include 0 we can reject the null hypothesis and state that there is a significant change in the mean kangaroo numbers between the 2 survey times. This would be true for both scenarios.\n\n\n\n\n\nPutting it together\nAs you should realise by now, the same data may produce different results depending on how it was analysed. This is the danger of statistics: not clearly understanding the assumptions and implications of an experimental design can lead to incorrect analysis and conclusions.\nAny statistical software, including R, will not tell you if you have made a mistake in your analysis. It is up to you to understand the implications of your design and to ensure that your work is appropriate.\nIn th case of this kangaroo study, the results are the same for both scenarios, which means that the implications lie in the context of future studies.\n\nQuestion 8\nIn the future, would you re-sample the same sites, or visit new sites in a kangaroo monitoring program of the same woodland?\n\n\n\n\n\n\nSolution 8\n\n\n\nIn this case, it would be better to resample the same locations as the baseline survey. This is because the 95% CI is narrower, and hence the precision of the estimate is higher. This means that we can detect smaller changes in the mean number of kangaroos between surveys.\nNote that the rationale here is that we are assuming that the same locations are representative of the woodland as a whole. If this is not the case, then we would need to consider a different approach."
  },
  {
    "objectID": "Lab02.html#exercise-4-equivalence-to-t-tests",
    "href": "Lab02.html#exercise-4-equivalence-to-t-tests",
    "title": "Lab 02",
    "section": "Exercise 4 – Equivalence to t-tests",
    "text": "Exercise 4 – Equivalence to t-tests\nThe scenario when we resample at different locations between surveys is actually the equivalent to a two-sample t-test, and the scenario when we resample the same locations is equivalent to a paired t-test.\nWithout manually calculating and comparing the 95% CI, we can use the t.test() function in R to perform both of these tests.\nCheck your answers in R by trying to perform both of these using the t.test() function. Assume the variances are equal for the two-sample t-test (use the argument var.equal = TRUEfor this).\n\nQuestion 9\nCompare the 95% CI for each scenario between the t.test() results and the ones you calculated manually. Are they same?\n\n\n\n\n\n\nSolution 9\n\n\n\n\n# Two-sample t-test\nfit1 &lt;- t.test(t2, t0, var.equal = TRUE)\n\n# Paired t-test\nfit2 &lt;- t.test(t2, t0, paired = TRUE)\n\nThe 95% CI for the two-sample t-test is 5.7946249, 11.4053751 and for the paired t-test is 5.2452086, 11.9547914.\nThe results are identical to the ones we calculated manually."
  },
  {
    "objectID": "Lab02.html#thanks",
    "href": "Lab02.html#thanks",
    "title": "Lab 02",
    "section": "Thanks!",
    "text": "Thanks!\nDid you know you can also knit to PDF? Check the documentation for R Markdown or Quarto for more information.\n\nAttribution\nThis lab was developed using resources that are available under a Creative Commons Attribution 4.0 International license, made available on the SOLES Open Educational Resources repository."
  }
]